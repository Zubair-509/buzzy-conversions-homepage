providers = ["node", "python"]

[variables]
NIXPACKS_PYTHON_VERSION = "3.11"

[phases.setup]
nixPkgs = [
    "poppler_utils",
    "ghostscript", 
    "cairo",
    "pango",
    "fontconfig",
    "freetype",
    "libjpeg-turbo",
    "libpng-apng",
    "zlib",
    "libxml2",
    "libxslt",
    "pkg-config"
]

[phases.install]
dependsOn = ["setup"]
cmds = [
    "npm ci",
    "pip install -r requirements.txt"
]

[phases.build]
dependsOn = ["install"]
cmds = ["npm run build"]

[start]
cmd = "npm run start:railway"